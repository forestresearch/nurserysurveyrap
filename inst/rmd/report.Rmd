---
title: 'Nursery Survey: Estimates of sales of improved nursery stock by forest nurseries
  in Great Britain'
output:
  word_document:
    reference_docx: fr_rep_template.docx
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#### Nursery Survey: Estimates of sales of improved nursery stock by forest nurseries in Great Britain

<br>

#### Release Date:
###### `r pub_date`

#### Coverage:
##### Great Britain

#### Geographical breakdown:
###### Great Britain and Scotland

<br>

| Issued by:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Forest Research, 
|                           Northern Research Station, Roslin, Midlothian, EH25 9SY 
| Enquiries:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0300 067 5238
|                           [statistics@forestresearch.gov.uk](mailto:statistics@forestresearch.gov.uk)
| Statistician:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`r stat_name` 
| Website:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[www.forestresearch.gov.uk/statistics](www.forestresearch.gov.uk/statistics)

#### ![Image caption: Badge for Accredited Official Statistics](../img/accredited_official_statistics_logo_english_hq.png){width=18%}\ 

\newpage

Forest Research is the Research Agency of the Forestry Commission and is the leading UK organisation engaged in forestry and tree related research. 

The Agency aims to support and enhance forestry and its role in sustainable development by providing innovative, high quality scientific research, data, technical support and consultancy services.

\newpage

# Introduction

This publication provides estimates of sales of improved nursery stock by nurseries in Great Britain each planting year (October to September). The data cover sales of Sitka spruce and Scots pine to public and private sector clients in Scotland. Sales of these species in Great Britain are also reported.

The data in this release have been obtained from a voluntary survey of nursery businesses in Great Britain, run on behalf of Scottish Forestry, to monitor the level of improved nursery stock.

"Improved nursery stock" refers to genetically improved Sitka spruce and Scots pine stock raised from seed of seed orchard origin and by vegetative propagation of parent material derived from controlled crosses. These trees are predicted to grow faster and produce better timber than unimproved stock.

Data for the planting year October `r (ref_year)` to September `r (ref_year + 1)` are published for the first time in this release. Data for earlier years are unchanged from those previously released. For further details, see [Forest Research's revisions policy](https://www.forestresearch.gov.uk/tools-and-resources/statistics/about-our-statistics/code-of-practice/quality-of-official-statistics/).


```{r load packages}
#| include: false

library(afcharts)
library(dplyr)
library(tidyr)
library(ggplot2)
library(gt)
library(sysfonts)
library(showtext)
library(lubridate)
library(readr)

use_afcharts()

```

```{r kf-summary-scot}
#| include: false

# 
all_scotland_im_n <- returns %>% 
  filter(year == current_year,
         country_sold_to == "Scotland",
         gi == TRUE) %>% 
  summarise(volume = sum(volume, na.rm = TRUE)) %>% 
  pull(volume)

# 
all_scotland_im_pct <- returns %>% 
  filter(year == current_year,
         country_sold_to == "Scotland") %>% 
  group_by(gi) %>% 
  summarise(volume = sum(volume, na.rm = TRUE)) %>% 
  ungroup() %>% 
  mutate(prop_pct = volume/sum(volume, na.rm = TRUE)) %>% 
  filter(gi == TRUE) %>% 
  pull(prop_pct)

# Annual change:
all_scotland_im_ac <- returns %>% 
  filter(year %in% c(prev_year,
                     current_year),
         gi == TRUE,
         country_sold_to == "Scotland") %>% 
  group_by(year) %>% 
  summarise(volume = sum(volume, na.rm = TRUE)) %>% 
  ungroup() %>% 
  mutate(ac_pct = (volume/lag(volume)) - 1) %>% 
  filter(year == current_year) %>% 
  pull(ac_pct)

# 
all_scotland_n <- returns %>% 
  filter(year == current_year,
         country_sold_to == "Scotland") %>% 
  summarise(volume = sum(volume, na.rm = TRUE)) %>% 
  pull(volume)

# 
scotland_sitka_n <- returns %>%
  filter(year == current_year,
         country_sold_to == "Scotland",
         tree_sp == "Sitka spruce") %>%
  summarise(volume = sum(volume, na.rm = TRUE)) %>%
  pull(volume)

#
scotland_sitka_pct <- returns %>%
  filter(year %in% c(prev_year,
                     current_year),
         country_sold_to == "Scotland",
         tree_sp == "Sitka spruce") %>%
  group_by(year) %>%
  summarise(volume = sum(volume, na.rm = TRUE)) %>%
  ungroup() %>%
  arrange(year) %>%
  mutate(change_pct = (volume/lag(volume)) - 1) %>%
  filter(year == current_year) %>%
  pull(change_pct)

#
scotland_scots_n <- returns %>%
  filter(year == current_year,
         country_sold_to == "Scotland",
         tree_sp == "Scots pine") %>%
  summarise(volume = sum(volume, na.rm = TRUE)) %>%
  pull(volume)

# 
scotland_scots_pct <- returns %>%
  filter(year %in% c(prev_year,
                     current_year),
         country_sold_to == "Scotland",
         tree_sp == "Scots pine") %>%
  group_by(year) %>%
  summarise(volume = sum(volume, na.rm = TRUE)) %>%
  ungroup() %>%
  arrange(year) %>%
  mutate(change_pct = (volume/lag(volume)) - 1) %>%
  filter(year == current_year) %>%
  pull(change_pct)
```

```{r kf-summary-gb}
#| include: false

#
all_gb_im_n <- returns %>% 
  filter(year == current_year,
         gi == TRUE) %>% 
  summarise(volume = sum(volume, na.rm = TRUE)) %>% 
  pull(volume)

# 
all_gb_im_pct <- returns %>% 
  filter(year == current_year) %>% 
  group_by(gi) %>% 
  summarise(volume = sum(volume, na.rm = TRUE)) %>% 
  ungroup() %>% 
  mutate(prop_pct = volume/sum(volume, na.rm = TRUE)) %>% 
  filter(gi == TRUE) %>% 
  pull(prop_pct)

# Annual change:
all_gb_im_ac <- returns %>% 
  filter(year %in% c(prev_year,
                     current_year),
         gi == TRUE) %>% 
  group_by(year) %>% 
  summarise(volume = sum(volume, na.rm = TRUE)) %>% 
  ungroup() %>% 
  mutate(ac_pct = (volume/lag(volume)) - 1) %>% 
  filter(year == current_year) %>% 
  pull(ac_pct)

# 
all_gb_n <- returns %>% 
  filter(year == current_year) %>% 
  summarise(volume = sum(volume, na.rm = TRUE)) %>% 
  pull(volume)

# 
gb_sitka_n <- returns %>%
  filter(year == current_year,
         tree_sp == "Sitka spruce") %>%
  summarise(volume = sum(volume, na.rm = TRUE)) %>%
  pull(volume)

#
gb_sitka_pct <- returns %>%
  filter(year %in% c(prev_year,
                     current_year),
         tree_sp == "Sitka spruce") %>%
  group_by(year) %>%
  summarise(volume = sum(volume, na.rm = TRUE)) %>%
  ungroup() %>%
  arrange(year) %>%
  mutate(change_pct = (volume/lag(volume)) - 1) %>%
  filter(year == current_year) %>%
  pull(change_pct)

#
gb_scots_n <- returns %>%
  filter(year == current_year,
         tree_sp == "Scots pine") %>%
  summarise(volume = sum(volume, na.rm = TRUE)) %>%
  pull(volume)

# 
gb_scots_pct <- returns %>%
  filter(year %in% c(prev_year,
                     current_year),
         tree_sp == "Scots pine") %>%
  group_by(year) %>%
  summarise(volume = sum(volume, na.rm = TRUE)) %>%
  ungroup() %>%
  arrange(year) %>%
  mutate(change_pct = (volume/lag(volume)) - 1) %>%
  filter(year == current_year) %>%
  pull(change_pct)

# 
all_gb_diff <- returns %>% 
  filter(gi == TRUE) %>% 
  group_by(year) %>% 
  summarise(volume = sum(volume, na.rm = TRUE)) %>% 
  ungroup() %>% 
  filter(year %in% c(prev_year,
                     current_year)) %>% 
  arrange(year) %>% 
  mutate(diff = volume - lag(volume),
         pct = diff/volume) %>% 
  filter(year == current_year) %>% 
  pull(diff)

# 
all_gb_pct <- returns %>% 
  filter(gi == TRUE) %>% 
  group_by(year) %>% 
  summarise(volume = sum(volume, na.rm = TRUE)) %>% 
  ungroup() %>% 
  filter(year %in% c(prev_year,
                     current_year)) %>% 
  arrange(year) %>% 
  mutate(diff = volume - lag(volume),
         pct = diff/volume) %>% 
  filter(year == current_year) %>% 
  pull(pct)


```


# Key findings

-   A total of `r frpubutils::round_fmt_rmd(all_scotland_im_n, 1)` million plants (`r percent(all_scotland_im_pct)`) derived from improved nursery stock were sold to Scotland in `r latest_year`.

-   Of all sales in Great Britain in `r latest_year`, `r round_fmt_rmd(all_gb_im_n, 1)` million plants (`r percent(all_gb_im_pct)`) were derived from improved nursery stock, `r perc_chg_text(all_gb_diff)` of `r percent(abs(all_gb_pct))` (or `r round_fmt_rmd(abs(all_gb_diff), 1)` million plants) compared with the previous year.

\newpage

# Sales of nursery stock to Scotland

An estimated total of `r round_fmt_rmd(all_scotland_n, 1)` million Sitka spruce and Scots pine plants were sold to Scotland in `r latest_year` (Table 1), comprising `r round_fmt_rmd(scotland_sitka_n, 1)` million Sitka spruce plants and `r round_fmt_rmd(scotland_scots_n, 1)` million Scots pine plants. This represents `r get_direction((scotland_sitka_pct * 100))` in sales of Sitka spruce (`r percent(scotland_sitka_pct)`) and `r get_direction((scotland_scots_pct * 100))` in sales of Scots pine (`r percent(scotland_scots_pct)`) from the previous year.

A total of `r round_fmt_rmd(all_scotland_im_n, 1)` million plants (`r percent(all_scotland_im_pct)`) derived from improved nursery stock were sold to Scotland in `r , `r get_perc_chg_text(all_scotland_im_ac)` of `r percent(all_scotland_im_ac)` compared with `r latest_year`.

#### Table 1: Summary table, Scotland, `r planting_year(ref_year- 1)`  to `r planting_year(current_year)`

```{r}
#| echo: false
#| message: false
table1 = returns %>% 
  filter(country_sold_to == "Scotland",
         year %in% c(prev_year, current_year)) %>% 
  mutate(label = paste(tree_sp, prod_method, sep = ": ")) %>% 
  group_by(year, label, gi) %>% 
  summarise(volume = sum(volume/1000000))


table1_sitka_tot = table1 %>%
  filter(label != "Scots pine: Seedlings") %>%
  group_by(year, gi) %>%
  summarise(volume = sum(volume)) %>%
  mutate(label = "Sitka spruce: Total")

table1_tot = table1 %>%
  group_by(year, gi) %>%
  summarise(volume = sum(volume)) %>%
  mutate(label = "Total")

rbind(table1, table1_sitka_tot, table1_tot) %>%
  group_by(year, label) %>%
  mutate(pct_improved = volume/sum(volume),
         volume_total = sum(volume)) %>% 
  ungroup() %>% 
  group_by(label, gi) %>% 
  mutate(volume_lag = lag(volume)) %>% 
  ungroup() %>% 
  filter(year == current_year,
         gi == TRUE) %>% 
  select(label, volume_total, volume, pct_improved) %>%
  mutate(volume_total = round_safe(volume_total, 1),
         volume = round_safe(volume, 1),
         pct_improved = round_safe(pct_improved*100, 1)) %>% 
  rename(paste0(`Total stock sold in ', latest_year, ' (million plants)`) = 2,
         `Improved stock sold in ', latest_year, ' (million plants)`) = 3,
         `Proportion improved (%)` = 4)  %>%
  gt(rowname_col = "label")



```



#### Figure 1: Sales of improved nursery stock, Scotland, 2005/06 to `r planting_year(current_year)`

```{r}
#| echo: false
#| message: false

returns %>% 
  filter(country_sold_to == "Scotland",
         gi == TRUE) %>% 
  mutate(label = paste(tree_sp, prod_method, sep = ": ")) %>% 
  summarise(volume = sum(volume, na.rm = TRUE), .by = c(year, label)) %>%
  ggplot(aes(year, volume/1000000, colour = label, group = label)) +
  geom_line(linewidth = 2) +
  scale_x_continuous(labels = planting_year) +
  scale_y_continuous(breaks = seq(0, 50, 10),
                     expand = expansion(mult = c(0, 0)),
                     limits = c(0, 60)) +
  labs(x = NULL,
       y = NULL,
       subtitle = "Improved stock (million plants)")

```

Figure 1 presents the sales of improved nursery stock to Scotland from `r planting_year(first_year)` to `r planting_year(current_year)` (planting seasons).

#### Table 2: Sales of improved nursery stock, Scotland, `r planting_year(ref_year - 10)` to `r latest_year`

```{r}
#| echo: false
#| message: false
t2 = returns %>% 
  filter(country_sold_to == "Scotland",
         gi == TRUE) %>% 
  mutate(label = paste(tree_sp, prod_method, sep = ": ")) %>% 
  summarise(volume = sum(volume/1000000, na.rm = TRUE), .by = c(year, label))

t2_tots = t2 %>%
  group_by(year) %>%
  summarise(volume = sum(volume, na.rm = TRUE)) %>%
  mutate(label = "Total")

t2_sitka_tots = t2 %>%
  filter(label != "Scots pine: Seedlings") %>%
  group_by(year) %>%
  summarise(volume = sum(volume, na.rm = TRUE)) %>%
  mutate(label = "Sitka spruce: Total")

table2 = rbind(t2, t2_sitka_tots, t2_tots)

table2 %>%
  pivot_wider(names_from = "label",
              values_from = "volume") %>% 
  arrange(year) %>%
  mutate(across(where(is.numeric), ~round_safe(.x, 1)),
         year = planting_year(year)) %>%
  gt(rowname_col = "year") %>%
  tab_stubhead("Planting year")
```


# Sales of nursery stock in Great Britain

An estimated total of `r round_fmt_rmd(all_gb_n, 1)` million Sitka spruce and Scots pine plants were sold to Scotland in `r planting_year(current_year)` (Table 1), comprising `r round_fmt_rmd(gb_sitka_n, 1)` million Sitka spruce plants and `r round_fmt_rmd(gb_scots_n, 1)` million Scots pine plants. This represents `r perc_chg_txt((gb_sitka_pct * 100))` in sales of Sitka spruce (`r percent(gb_sitka_pct)`) and `r perc_chg_txt((gb_scots_pct * 100))` in sales of Scots pine (`r percent(gb_scots_pct)`) from the previous year.

A total of `r round_fmt_rmd(all_gb_im_n, 1)` million plants (`r percent(all_gb_im_pct)`) derived from improved nursery stock were sold to Scotland in `r planting_year(current_year)`, `r perc_chg_txt(all_gb_im_ac)` of `r percent(all_gb_im_ac)` compared with `r planting_year(prev_year)`.



#### Table 3: Summary table, Great Britain, `r latest_year`

```{r}
#| echo: false
#| message: false
table3 = returns %>% 
  filter(year %in% c(prev_year, current_year)) %>% 
  mutate(label = paste(tree_sp, prod_method, sep = ": ")) %>% 
  group_by(year, label, gi) %>% 
  summarise(volume = sum(volume/1000000))


table3_sitka_tot = table1 %>%
  filter(label != "Scots pine: Seedlings") %>%
  group_by(year, gi) %>%
  summarise(volume = sum(volume)) %>%
  mutate(label = "Sitka spruce: Total")

table3_tot = table1 %>%
  group_by(year, gi) %>%
  summarise(volume = sum(volume)) %>%
  mutate(label = "Total")

rbind(table3, table3_sitka_tot, table3_tot) %>%
  group_by(year, label) %>%
  mutate(pct_improved = volume/sum(volume),
         volume_total = sum(volume)) %>% 
  ungroup() %>% 
  group_by(label, gi) %>% 
  mutate(volume_lag = lag(volume)) %>% 
  ungroup() %>% 
  filter(year == current_year,
         gi == TRUE) %>% 
  select(label, volume_total, volume, pct_improved) %>%
  mutate(volume_total = round_safe(volume_total, 1),
         volume = round_safe(volume, 1),
         pct_improved = round_safe(pct_improved*100, 1)) %>% 
  rename(paste0(`Total stock sold in ', latest_year, ' (million plants)` = 2,),
         paste0(`Improved stock sold in ', latest_year, ' (million plants)`) = 3,
         `Proportion improved (%)` = 4)  %>%
  gt(rowname_col = "label")
```

#### Figure 2: Sales of improved nursery stock, Great Britain, 2005/06 to `r planting_year(current_year)`

```{r}
#| echo: false
#| message: false

returns %>% 
  filter(gi == TRUE) %>% 
  mutate(label = paste(tree_sp, prod_method, sep = ": ")) %>%
  summarise(volume = sum(volume/1000000, na.rm = TRUE), .by = c(year, label)) %>% 
  ggplot(aes(year, volume, colour = label, group = label)) +
  geom_line(linewidth = 2) +
  scale_x_continuous(labels = planting_year) +
  scale_y_continuous(breaks = seq(0, 60, 10),
                     expand = expansion(mult = c(0, 0)),
                     limits = c(0, 60)) +
  labs(x = NULL,
       y = NULL,
       subtitle = "Improved stock (million plants)")
```

Figure 2 shows the volume/quantity improved stock sold in Great Britain, from  2005/06 to `r latest_year`

Since the 2005/06 planting season, improved Sitka spruce seedlings have reported more than a two-fold increase in sales. Sales of improved Sitka spruce VP and improved Scots pine seedlings have both remained relatively constant throughout.

#### Table 4: Sales of improved nursery stock, Great Britain, `r planting_year(ref_year - 10)` to `r latest_year`

```{r}
#| echo: false
#| message: false
t4 = returns %>% 
  filter(gi == TRUE) %>% 
  mutate(label = paste0(tree_sp, ": ", prod_method)) %>%
  summarise(volume = sum(volume/1000000, na.rm = TRUE), .by = c(year, label))

t4_tots = t4 %>%
  group_by(year) %>%
  summarise(volume = sum(volume, na.rm = TRUE)) %>%
  mutate(label = "Total")

t4_sitka_tots = t4 %>%
  filter(label != "Scots pine: Seedlings") %>%
  group_by(year) %>%
  summarise(volume = sum(volume, na.rm = TRUE)) %>%
  mutate(label = "Sitka spruce: Total")

rbind(t4, t4_sitka_tots, t4_tots) %>%
  pivot_wider(names_from = "label",
              values_from = "volume") %>% 
  arrange(year) %>%
  mutate(across(where(is.numeric), ~round_safe(.x, 1)),
         year = planting_year(year)) %>%
  gt(rowname_col = "year") %>%
  tab_stubhead("Planting year")
```

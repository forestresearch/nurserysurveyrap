---
title: "Nursery Survey"
output:
  word_document:
    reference_docx: fr_rep_template.docx
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

##### `r ref_year`

<br>

#### Release Date:
###### `r pub_date`

#### Coverage:
###### Great Britain

#### Geographical breakdown:
###### Great Britain and Scotland

<br>

| Issued by:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Forest Research, 
|                           Northern Research Station, Roslin, Midlothian, EH25 9SY 
| Enquiries:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0300 067 5238
|                           [statistics@forestresearch.gov.uk](mailto:statistics@forestresearch.gov.uk)
| Statistician:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`r stat_name` 
| Website:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[www.forestresearch.gov.uk/statistics](www.forestresearch.gov.uk/statistics)

#### ![Image caption: Badge for Accredited Official Statistics](../img/accredited_official_statistics_logo_english_hq.png){width=18%}\ 

\newpage

Forest Research is the Research Agency of the Forestry Commission and is the leading UK organisation engaged in forestry and tree related research. 

The Agency aims to support and enhance forestry and its role in sustainable development by providing innovative, high quality scientific research, data, technical support and consultancy services.

\newpage

# Introduction

This publication provides estimates of sales of improved nursery stock by nurseries in Great Britain each planting year (October to September). The data cover sales of Sitka spruce and Scots pine to public and private sector clients in Scotland. Sales of these species in Great Britain are also reported.

The data in this release have been obtained from a voluntary survey of nursery businesses in Great Britain, run on behalf of Scottish Forestry, to monitor the level of improved nursery stock.

"Improved nursery stock" refers to genetically improved Sitka spruce and Scots pine stock raised from seed of seed orchard origin and by vegetative propagation of parent material derived from controlled crosses. These trees are predicted to grow faster and produce better timber than unimproved stock.

Data for the planting year October `r (ref_year - 2)` to September `r (ref_year - 1)` are published for the first time in this release. Data for earlier years are unchanged from those previously released. For further details, see [Forest Research's revisions policy](https://www.forestresearch.gov.uk/tools-and-resources/statistics/about-our-statistics/code-of-practice/quality-of-official-statistics/).

\newpage

```{r load packages}
#| include: false

library(afcharts)
library(dplyr)
library(tidyr)
library(ggplot2)
library(gt)
library(sysfonts)
library(showtext)
library(lubridate)
library(readr)

use_afcharts()

```

```{r kf-summary-scot}
#| include: false

# 
all_scotland_im_n <- returns %>% 
  filter(year == ref_year - 2,
         country_sold_to == "Scotland",
         gi == TRUE) %>% 
  summarise(volume = sum(volume/1000000, na.rm = TRUE)) %>% 
  pull(volume) %>% frpubutils::round_fmt_rmd(., 1)

# 
all_scotland_im_pct <- returns %>% 
  filter(year == ref_year - 2,
         country_sold_to == "Scotland") %>% 
  group_by(gi) %>% 
  summarise(volume = sum(volume/1000000, na.rm = TRUE)) %>% 
  ungroup() %>% 
  mutate(prop_pct = (volume/sum(volume, na.rm = TRUE)) * 100) %>% 
  filter(gi == TRUE) %>% 
  pull(prop_pct) %>% frpubutils::round_safe(., 0)

# Annual change:
all_scotland_im_ac <- returns %>% 
  filter(year %in% c(ref_year - 3,
                     ref_year - 2),
         gi == TRUE,
         country_sold_to == "Scotland") %>% 
  group_by(year) %>% 
  summarise(volume = sum(volume, na.rm = TRUE)) %>% 
  ungroup() %>% 
  mutate(ac_pct = ((volume/lag(volume)) - 1) * 100) %>% 
  filter(year == ref_year - 2) %>% 
  pull(ac_pct) %>% frpubutils::round_safe(., 0)

# 
all_scotland_n <- returns %>% 
  filter(year == ref_year - 2,
         country_sold_to == "Scotland") %>% 
  summarise(volume = sum(volume, na.rm = TRUE)/1000000) %>% 
  pull(volume) %>% frpubutils::round_fmt_rmd(., 1)

# 
scotland_sitka_n <- returns %>%
  filter(year == ref_year - 2,
         country_sold_to == "Scotland",
         tree_sp == "Sitka spruce") %>%
  summarise(volume = sum(volume, na.rm = TRUE)/1000000) %>%
  pull(volume) %>% frpubutils::round_fmt_rmd(., 1)

#
scotland_sitka_pct <- returns %>%
  filter(year %in% c(ref_year - 3,
                     ref_year - 2),
         country_sold_to == "Scotland",
         tree_sp == "Sitka spruce") %>%
  group_by(year) %>%
  summarise(volume = sum(volume, na.rm = TRUE)) %>%
  ungroup() %>%
  arrange(year) %>%
  mutate(change_pct = ((volume/lag(volume)) - 1) * 100) %>%
  filter(year == ref_year - 2) %>%
  pull(change_pct) %>% frpubutils::round_safe(., 0)

#
scotland_scots_n <- returns %>%
  filter(year == ref_year - 2,
         country_sold_to == "Scotland",
         tree_sp == "Scots pine") %>%
  summarise(volume = sum(volume, na.rm = TRUE)/1000000) %>%
  pull(volume) %>% frpubutils::round_fmt_rmd(., 1)

# 
scotland_scots_pct <- returns %>%
  filter(year %in% c(ref_year - 3,
                     ref_year - 2),
         country_sold_to == "Scotland",
         tree_sp == "Scots pine") %>%
  group_by(year) %>%
  summarise(volume = sum(volume, na.rm = TRUE)) %>%
  ungroup() %>%
  arrange(year) %>%
  mutate(change_pct = ((volume/lag(volume)) - 1) * 100) %>%
  filter(year == ref_year - 2) %>%
  pull(change_pct) %>% frpubutils::round_safe(., 0)
```

```{r kf-summary-gb}
#| include: false

#
all_gb_im_n <- returns %>% 
  filter(year == ref_year - 2,
         gi == TRUE) %>% 
  summarise(volume = sum(volume/1000000, na.rm = TRUE)) %>% 
  pull(volume) %>% frpubutils::round_fmt_rmd(., 1)

# 
all_gb_im_pct <- returns %>% 
  filter(year == ref_year - 2) %>% 
  group_by(gi) %>% 
  summarise(volume = sum(volume, na.rm = TRUE)) %>% 
  ungroup() %>% 
  mutate(prop_pct = volume/sum(volume, na.rm = TRUE) * 100) %>% 
  filter(gi == TRUE) %>% 
  pull(prop_pct) %>% frpubutils::round_safe(., 0)

# Annual change:
all_gb_im_ac <- returns %>% 
  filter(year %in% c(ref_year - 3,
                     ref_year - 2),
         gi == TRUE) %>% 
  group_by(year) %>% 
  summarise(volume = sum(volume, na.rm = TRUE)) %>% 
  ungroup() %>% 
  mutate(ac_pct = ((volume/lag(volume)) - 1) * 100) %>% 
  filter(year == ref_year - 2) %>% 
  pull(ac_pct) %>% frpubutils::round_safe(., 0)

# 
all_gb_n <- returns %>% 
  filter(year == ref_year - 2) %>% 
  summarise(volume = sum(volume, na.rm = TRUE)/1000000) %>% 
  pull(volume) %>% frpubutils::round_fmt_rmd(., 1)

# 
gb_sitka_n <- returns %>%
  filter(year == ref_year - 2,
         tree_sp == "Sitka spruce") %>%
  summarise(volume = sum(volume, na.rm = TRUE)/1000000) %>%
  pull(volume) %>% frpubutils::round_fmt_rmd(., 1)

#
gb_sitka_pct <- returns %>%
  filter(year %in% c(ref_year - 3,
                     ref_year - 2),
         tree_sp == "Sitka spruce") %>%
  group_by(year) %>%
  summarise(volume = sum(volume, na.rm = TRUE)) %>%
  ungroup() %>%
  arrange(year) %>%
  mutate(change_pct = ((volume/lag(volume)) - 1) * 100) %>%
  filter(year == ref_year - 2) %>%
  pull(change_pct) %>% frpubutils::round_safe(., 0)

#
gb_scots_n <- returns %>%
  filter(year == ref_year - 2,
         tree_sp == "Scots pine") %>%
  summarise(volume = sum(volume, na.rm = TRUE)/1000000) %>%
  pull(volume) %>% frpubutils::round_fmt_rmd(., 1)

# 
gb_scots_pct <- returns %>%
  filter(year %in% c(ref_year - 3,
                     ref_year - 2),
         tree_sp == "Scots pine") %>%
  group_by(year) %>%
  summarise(volume = sum(volume, na.rm = TRUE)) %>%
  ungroup() %>%
  arrange(year) %>%
  mutate(change_pct = ((volume/lag(volume)) - 1) * 100) %>%
  filter(year == ref_year - 2) %>%
  pull(change_pct) %>% frpubutils::round_safe(., 0)

# 
all_gb_diff <- returns %>% 
  filter(gi == TRUE) %>% 
  group_by(year) %>% 
  summarise(volume = sum(volume, na.rm = TRUE)) %>% 
  ungroup() %>% 
  filter(year %in% c(ref_year - 3,
                     ref_year - 2)) %>% 
  arrange(year) %>% 
  mutate(diff = (volume - lag(volume))/1000000,
         pct = diff/volume) %>% 
  filter(year == ref_year - 2) %>% 
  pull(diff) %>% frpubutils::round_fmt_rmd(., 1)

# 
all_gb_pct <- returns %>% 
  filter(gi == TRUE) %>% 
  group_by(year) %>% 
  summarise(volume = sum(volume, na.rm = TRUE)) %>% 
  ungroup() %>% 
  filter(year %in% c(ref_year - 3,
                     ref_year - 2)) %>% 
  arrange(year) %>% 
  mutate(diff = volume - lag(volume),
         pct = diff/volume) %>% 
  filter(year == ref_year - 2) %>% 
  pull(pct) %>% frpubutils::round_safe(., 0)


```

# Key findings

-   A total of `r all_scotland_im_n` million plants (`r paste0(all_scotland_im_pct, " %")`) derived from improved nursery stock were sold to Scotland in `r latest_year`.

-   Of all sales in Great Britain in `r latest_year`, `r all_gb_im_n` million plants (`r paste0(all_gb_im_pct, "%")`) were derived from improved nursery stock, `r frpubutils::perc_chg_text(all_gb_im_ac)` (or `r all_gb_diff` million plants) compared with the previous year.

\newpage


# Sales of nursery stock to Scotland

An estimated total of `r all_scotland_n` million Sitka spruce and Scots pine plants were sold to Scotland in `r latest_year` (Table 1), comprising `r scotland_sitka_n` million Sitka spruce plants and `r scotland_scots_n` million Scots pine plants. This represents `r frpubutils::perc_chg_text(scotland_sitka_pct)` in sales of Sitka spruce and `r frpubutils::perc_chg_text(scotland_scots_pct)` in sales of Scots pine from the previous year.

A total of `r all_scotland_im_n` million plants (`r paste0(all_scotland_im_pct, " %")`) derived from improved nursery stock were sold to Scotland in `r latest_year`, `r frpubutils::perc_chg_text(all_scotland_im_ac)` compared with `r previous_year` (Table 2).

#### Table 1: Summary table, Scotland, `r latest_year`

```{r table 1, echo = FALSE, message = FALSE}


  
table1 <- table1 %>%
  frpubutils::ft_tbl_fmtd(col_names = c("Plant", paste0("Total stock sold in ", latest_year, " (million plants)"),
                                        paste0("Improved stock sold in ", latest_year, " (million plants)"),
                                        "Proportion improved (%)"),
                          round_it = FALSE) %>%
  flextable::bold(i = c(4,5), j = 1:4)




```

`r table1`
<br>

Note:

1.	Results for respondents only. This is estimates to account for around 95 to 100% of all sales of Sitka spruce and Scots pine.
\newpage

Figure 1 presents the sales of improved nursery stock to Scotland from `r first_year` to `r latest_year` (planting seasons).

#### Figure 1: Sales of improved nursery stock, Scotland, `r first_year` to `r latest_year` 

Improved stock (million plants)

```{r fig1, dpi = 250, fig.width = 8, fig.height = 4, warning = FALSE, message = FALSE, echo=FALSE}
ns_figs$fig1
```
<br>

Note:

1.	Results for respondents only. This is estimates to account for around 95 to 100% of all sales of Sitka spruce and Scots pine.

\newpage

#### Table 2: Sales of improved nursery stock, Scotland, `r ten_ago` to `r latest_year`

```{r table 2, echo = FALSE, message = FALSE}


  
table2 <- table2 %>%
  frpubutils::ft_tbl_fmtd(col_names = c("Planting year", "Sitka spruce: seedlings", "Sitka spruce: VP", "Sitka spruce: Total", "Scots pine: Seedlings", "Total",
                          round_it = FALSE))




```

`r table2`
<br>

Note:

1.	Results for respondents only. This is estimates to account for around 95 to 100% of all sales of Sitka spruce and Scots pine.

\newpage

# Sales of nursery stock in Great Britain

An estimated total of `r all_gb_n` million Sitka spruce and Scots pine plants were sold in Great Britain in `r latest_year` (Table 3), comprising `r gb_sitka_n` million Sitka spruce plants and `r gb_scots_n` million Scots pine plants. This represents `r frpubutils::perc_chg_text(gb_sitka_pct)` in sales of Sitka spruce (`r paste0(gb_sitka_pct, "%")`) and `r frpubutils::perc_chg_text(gb_scots_pct)` in sales of Scots pine (`r paste0(gb_scots_pct, "%")`) from the previous year.

A total of `r all_gb_im_n` million plants (`r paste0(all_gb_im_pct, "%")`) derived from improved nursery stock were sold in Great Britain in `r latest_year`, `r frpubutils::perc_chg_text(all_gb_im_ac)` compared with `r previous_year`.



#### Table 3: Summary table, Great Britain, `r latest_year`
```{r table 3, echo = FALSE, message = FALSE}


  
table3 <- table3 %>%
  frpubutils::ft_tbl_fmtd(col_names = c("Plant", paste0("Total stock sold in ", latest_year, " (million plants)"),
                                        paste0("Improved stock sold in ", latest_year, " (million plants)"),
                                        "Proportion improved (%)"),
                          round_it = FALSE) %>%
  flextable::bold(i = c(4,5), j = 1:4)




```

`r table3`
<br>

Note:

1.	Results for respondents only. This is estimates to account for around 95 to 100% of all sales of Sitka spruce and Scots pine.
\newpage

Figure 2 shows the total sales for all improved stock sold in Great Britain, from  `r first_year` to `r latest_year`

Since the 2005/06 planting season, improved Sitka spruce seedlings have reported more than a two-fold increase in sales. Sales of improved Sitka spruce VP and improved Scots pine seedlings have both remained relatively constant throughout.

#### Figure 2: Sales of improved nursery stock, Great Britain, 2005/06 to `r latest_year`

Improved stock (million plants)

```{r fig2, dpi = 250, fig.width = 8, fig.height = 4, warning = FALSE, message = FALSE, echo=FALSE}
ns_figs$fig2
```
<br>
Note:

1.	Results for respondents only. This is estimates to account for around 95 to 100% of all sales of Sitka spruce and Scots pine.
\newpage

#### Table 4: Sales of improved nursery stock, Great Britain, `r ten_ago` to `r latest_year`

```{r table 4, echo = FALSE, message = FALSE}


  
table4 <- table4 %>%
  frpubutils::ft_tbl_fmtd(col_names = c("Planting year", "Sitka spruce: seedlings", "Sitka spruce: VP", "Sitka spruce: Total", "Scots pine: Seedlings", "Total",
                          round_it = FALSE))




```

`r table4`
<br>

Note:

1.	Results for respondents only. This is estimates to account for around 95 to 100% of all sales of Sitka spruce and Scots pine.
